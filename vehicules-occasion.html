<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Découvrez nos véhicules d'occasion et récents (moins de 3 ans). Large choix de voitures à prix compétitifs pour la France et l'Europe.">
    <title>Véhicules d'Occasion - MBOULHI AUTO</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/vehicules.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Header / Navigation -->
    <header class="header" id="header">
        <nav class="navbar">
            <div class="container">
                <div class="nav-wrapper">
                    <a href="index.html" class="logo">
                        <img src="images/logo.png" alt="MBOULHI AUTO Logo">
                    </a>

                    <button class="nav-toggle" id="navToggle" aria-label="Toggle navigation">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>

                    <ul class="nav-menu" id="navMenu">
                        <li><a href="index.html" class="nav-link">Accueil</a></li>
                        <li><a href="vehicules-neufs.html" class="nav-link">Véhicules Neufs</a></li>
                        <li><a href="vehicules-occasion.html" class="nav-link active">Véhicules d'Occasion</a></li>
                        <li><a href="about.html" class="nav-link">À Propos</a></li>
                        <li><a href="contact.html" class="nav-link">Contact</a></li>
                    </ul>

                    <div class="nav-actions">
                        <a href="https://wa.me/33636121035" class="btn btn-call" target="_blank">
                            <i class="fab fa-whatsapp"></i> WhatsApp
                        </a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <!-- Page Header -->
    <section class="page-header" style="background-image: url('images/occasion-couverture.jpeg'); background-size: cover; background-position: center;">
        <div class="page-header-overlay"></div>
        <div class="container" style="position: relative; z-index: 1;">
            <h1 class="page-title">Véhicules d'Occasion</h1>
            <p class="page-subtitle">Véhicules d'occasion et récents (moins de 3 ans) pour la France et l'Europe</p>
        </div>
    </section>

    <!-- Filtres -->
    <section class="filters-section section">
        <div class="container">
            <div class="filters-header">
                <h2><i class="fas fa-filter"></i> Filtrer les véhicules</h2>
                <button id="resetFilters" class="btn-reset">
                    <i class="fas fa-redo"></i> Réinitialiser
                </button>
            </div>

            <div class="filters-grid">
                <!-- Catégorie -->
                <div class="filter-group">
                    <label for="filterCategory">
                        <i class="fas fa-tag"></i> Catégorie
                    </label>
                    <select id="filterCategory" class="filter-input">
                        <option value="">Toutes catégories</option>
                        <option value="recent">Moins de 3 ans</option>
                        <option value="occasion">Occasion classique</option>
                    </select>
                </div>


                <!-- Marque -->
                <div class="filter-group">
                    <label for="filterBrand">
                        <i class="fas fa-car"></i> Marque
                    </label>
                    <input type="text" id="filterBrand" class="filter-input" placeholder="Ex: Peugeot">
                </div>

                <!-- Prix minimum -->
                <div class="filter-group">
                    <label for="filterMinPrice">
                        <i class="fas fa-euro-sign"></i> Prix min
                    </label>
                    <input type="number" id="filterMinPrice" class="filter-input" placeholder="0 €" min="0" step="1000">
                </div>

                <!-- Prix maximum -->
                <div class="filter-group">
                    <label for="filterMaxPrice">
                        <i class="fas fa-euro-sign"></i> Prix max
                    </label>
                    <input type="number" id="filterMaxPrice" class="filter-input" placeholder="50 000 €" min="0" step="1000">
                </div>

                <!-- Carburant -->
                <div class="filter-group">
                    <label for="filterFuel">
                        <i class="fas fa-gas-pump"></i> Carburant
                    </label>
                    <select id="filterFuel" class="filter-input">
                        <option value="">Tous</option>
                        <option value="Essence">Essence</option>
                        <option value="Diesel">Diesel</option>
                        <option value="Électrique">Électrique</option>
                        <option value="Hybride">Hybride</option>
                    </select>
                </div>

                <!-- Transmission -->
                <div class="filter-group">
                    <label for="filterTransmission">
                        <i class="fas fa-cog"></i> Transmission
                    </label>
                    <select id="filterTransmission" class="filter-input">
                        <option value="">Toutes</option>
                        <option value="Manuelle">Manuelle</option>
                        <option value="Automatique">Automatique</option>
                    </select>
                </div>
            </div>
        </div>
    </section>

    <!-- Résultats -->
    <section class="vehicles-section section section-dark">
        <div class="container">
            <div class="results-header">
                <h2 id="resultsCount">Chargement...</h2>
                <div class="view-options">
                    <button class="view-btn active" data-view="grid" title="Vue grille">
                        <i class="fas fa-th"></i>
                    </button>
                    <button class="view-btn" data-view="list" title="Vue liste">
                        <i class="fas fa-list"></i>
                    </button>
                </div>
            </div>

            <div class="vehicles-grid" id="vehiclesContainer">
                <!-- Les véhicules seront chargés dynamiquement via JavaScript -->
                <div style="grid-column: 1/-1; text-align: center; padding: 3rem;">
                    <i class="fas fa-spinner fa-spin" style="font-size: 3rem; color: var(--primary-color);"></i>
                    <p style="margin-top: 1rem; color: var(--text-white);">Chargement des véhicules...</p>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta-section">
        <div class="container">
            <div class="cta-content">
                <h2>Vous n'avez pas trouvé ce que vous cherchez ?</h2>
                <p>Contactez-nous et nous trouverons le véhicule idéal pour vous</p>
                <div class="cta-buttons">
                    <a href="https://wa.me/33636121035" class="btn btn-whatsapp" target="_blank">
                        <i class="fab fa-whatsapp"></i> WhatsApp
                    </a>
                    <a href="tel:+33636121035" class="btn btn-phone">
                        <i class="fas fa-phone"></i> Appeler
                    </a>
                    <a href="contact.html" class="btn btn-outline-white">
                        <i class="fas fa-envelope"></i> Email
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-column">
                    <img src="images/logo.png" alt="MBOULHI AUTO" class="footer-logo">
                    <p class="footer-description">
                        Votre partenaire de confiance pour l'achat de véhicules neufs et d'occasion.
                        Spécialistes de l'export France - Algérie - Europe.
                    </p>
                    <div class="social-links">
                        <a href="#" target="_blank" aria-label="TikTok"><i class="fab fa-tiktok"></i></a>
                        <a href="#" target="_blank" aria-label="Facebook"><i class="fab fa-facebook"></i></a>
                        <a href="#" target="_blank" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                        <a href="#" target="_blank" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>

                <div class="footer-column">
                    <h4>Liens Rapides</h4>
                    <ul class="footer-links">
                        <li><a href="index.html">Accueil</a></li>
                        <li><a href="vehicules-neufs.html">Véhicules Neufs</a></li>
                        <li><a href="vehicules-occasion.html">Véhicules d'Occasion</a></li>
                        <li><a href="services.html">Services</a></li>
                        <li><a href="about.html">À Propos</a></li>
                        <li><a href="contact.html">Contact</a></li>
                    </ul>
                </div>

                <div class="footer-column">
                    <h4>Nos Véhicules</h4>
                    <ul class="footer-links">
                        <li><a href="vehicules-neufs.html">Véhicules Neufs (Export)</a></li>
                        <li><a href="vehicules-occasion.html">Véhicules d'Occasion</a></li>
                        <li><a href="services.html#export">Export International</a></li>
                        <li><a href="services.html#reprise">Reprise Véhicule</a></li>
                    </ul>
                </div>

                <div class="footer-column">
                    <h4>Contact</h4>
                    <ul class="footer-contact">
                        <li>
                            <i class="fas fa-phone"></i>
                            <a href="tel:+33636121035">+33 6 36 12 10 35</a>
                        </li>
                        <li>
                            <i class="fas fa-envelope"></i>
                            <a href="mailto:contact@mboulhiauto.fr">contact@mboulhiauto.fr</a>
                        </li>
                        <li>
                            <i class="fas fa-map-marker-alt"></i>
                            <span>69 chem. Neuf, 69780 Toussieu</span>
                        </li>
                        <li>
                            <i class="fas fa-clock"></i>
                            <span>Mar-Dim: 10h-19h</span>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="footer-bottom">
                <p>&copy; 2024 MBOULHI AUTO. Tous droits réservés.</p>
                <div class="footer-legal">
                    <a href="#">Mentions Légales</a>
                    <a href="#">Politique de Confidentialité</a>
                    <a href="#">CGV</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bouton WhatsApp flottant -->
    <a href="https://wa.me/33636121035" class="whatsapp-float" target="_blank" aria-label="Contactez-nous sur WhatsApp">
        <i class="fab fa-whatsapp"></i>
    </a>

    <!-- Bouton retour en haut -->
    <button class="scroll-top" id="scrollTop" aria-label="Retour en haut">
        <i class="fas fa-arrow-up"></i>
    </button>

    
    <script src="js/vehicles-api.js"></script>
    <script src="js/main.js"></script>
    <script>
        // Filtrer uniquement les véhicules d'occasion (recent + occasion)
        document.addEventListener('DOMContentLoaded', async function() {
            // Forcer le filtre pour n'afficher que les occasions et récents
            currentFilters.excludeNeuf = true;
            await displayVehiclesOccasion();

            // Gestion du filtre catégorie
            const filterCategory = document.getElementById('filterCategory');
            if (filterCategory) {
                filterCategory.addEventListener('change', function() {
                    if (this.value === 'recent') {
                        currentFilters.type = 'recent';
                    } else if (this.value === 'occasion') {
                        currentFilters.type = 'occasion';
                    } else {
                        delete currentFilters.type;
                    }
                    displayVehiclesOccasion();
                });
            }
        });

        // Fonction personnalisée pour afficher les véhicules d'occasion
        function displayVehiclesOccasion() {
            const vehiclesContainer = document.getElementById('vehiclesContainer');
            const resultsCount = document.getElementById('resultsCount');

            if (!vehiclesContainer) return;

            // Nettoyer les filtres vides
            const cleanFilters = {};
            for (let key in currentFilters) {
                if (currentFilters[key]) {
                    cleanFilters[key] = currentFilters[key];
                }
            }

            // Obtenir les véhicules et filtrer pour exclure les neufs
            let vehicles = filterVehicles(cleanFilters);
            vehicles = vehicles.filter(v => {
                // Garder seulement les véhicules qui ont "occasion" ou "recent" dans leurs types
                return v.types && (v.types.includes('occasion') || v.types.includes('recent'));
            });

            // Afficher le nombre de résultats
            if (resultsCount) {
                resultsCount.textContent = `${vehicles.length} véhicule${vehicles.length > 1 ? 's' : ''} trouvé${vehicles.length > 1 ? 's' : ''}`;
            }

            // Afficher les véhicules
            vehiclesContainer.innerHTML = '';

            if (vehicles.length === 0) {
                vehiclesContainer.innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 3rem;">
                        <i class="fas fa-search" style="font-size: 3rem; color: var(--text-light); margin-bottom: 1rem;"></i>
                        <h3>Aucun véhicule trouvé</h3>
                        <p style="color: var(--text-light);">Essayez de modifier vos critères de recherche</p>
                    </div>
                `;
                return;
            }

            vehicles.forEach(vehicle => {
                const card = createVehicleCard(vehicle);
                vehiclesContainer.appendChild(card);
            });
        }
    </script>
</body>
</html>
